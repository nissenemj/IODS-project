# Työ 2

*Describe the work you have done this week and summarize your learning.*

- Describe your work and results clearly. 
- Assume the reader has an introductory course level understanding of writing and reading R code as well as statistical methods.
- Assume the reader has no previous knowledge of your data or the more advanced methods you are using.


# Toinen harjoitus

__DATA tuonti__
data <- read.csv("learing_2019.csv")

#Summary
summary(data)

#Access ggplot and GGally
library(ggplot2)
install.packages("ggplot2")
library(GGally)
install.packages("GGally")

#Creating graphics
p1 <- ggplot(data, aes(x = Attitude, y = Points, col = gender))

#and fitting linear model
p2 <- p1 + geom_point() + geom_smooth(method = "lm")
p2

Tässä nähdään asenteen ja pisteiden suhde, joka näyttäytyy jyrkemmältä miehillä. 


#Correlations

p <- ggpairs(data, mapping = aes(col = gender, alpha = 0.3), lower = list(combo = wrap("facethist", bins = 20)))
p
     
## Regression model with multible explanatory variables
my_model <- lm(Points ~ Attitude + Stra + Surf, data = data)

# Summary of the model
summary(my_model)


Residuals:
     Min       1Q   Median       3Q      Max 
-17.1550  -3.4346   0.5156   3.6401  10.8952 

Coefficients:
            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 11.01711    3.68375   2.991  0.00322 ** 
Attitude     0.33952    0.05741   5.913 1.93e-08 ***
Stra         0.85313    0.54159   1.575  0.11716    
Surf        -0.58607    0.80138  -0.731  0.46563    

Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 5.296 on 162 degrees of freedom
Multiple R-squared:  0.2074,	Adjusted R-squared:  0.1927 
F-statistic: 14.13 on 3 and 162 DF,  p-value: 3.156e-08


Ainoastaan asenne on merkittävä tekijä luodussa mallissa. Sillä on positiivinen vaikutus pisteisiin. 20% pisteistä saadaan selitettyä käytetyllä kaavalla. 



# drawing diagnostic plots using the plot() function. Residuals vs Fitted values, Normal QQ-plot and Residuals vs Leverage.
par(mfrow = c(2,2))
plot(my_model, which = c(1,2,5))


Kuvista nähdään, että jakauma on varsin lineaarinen, ei merkittäviä outliereita.

     